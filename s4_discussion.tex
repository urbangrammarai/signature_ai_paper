\section{Discussion and conclusion} % 500 words in total
\label{sec:discussion}

% Summarise results
The results can be summarised in four dimensions.
%% Architecture dimension (BIC, SIC, MOR)
The first dimension tested is the way of chip sampling and related CNN architecture.
It seems clear that the baseline image classification is limited, and either the
sliding approach to minimise the disbalance of sample size per class or multi-output
regression shall be preferred in a use case like signature detection. Of the two,
multi-output regression even seems to be better, and one of the reasons could be its
ability to implicitly capture co-location. While BIC and SIC-based models have no
information on
the geographical relationship between neighbouring signature types, MOR directly
captures these as chips often cross multiple signature types. This behaviour is unique
to geographical problems. Aspatial image classification tasks are not able to encode
\textit{distance} between two types in this way. Still, sliding significantly improves the
performance when considering the global Macro F1 score and within-class accuracy, making
it a viable option if we want to stick to the traditional image classification approach.

%% Chip size dimension
The second dimension is the chip size. Except for Join Counts statistics, we see a positive
relationship between model performance and the extent our chips cover. This is an expected
outcome as the larger the chip is, the more information it contains. However, we cannot
blindly follow \textit{larger is better} logic as signature types are composed of
granular geometries, and we see a sampling issue when the chip size grows. While that
can be partially mitigated by using MOR for single-class prediction, it needs to be considered in model
architecture. The results do not suggest that one of the options is the \textit{sweet spot}
of the balance between sample size and amount of within-a-chip data.

%% Modelling dimension
Another dimension looks at the value of modelling on top of probabilities coming from
neural networks. The results indicate that there is value in the modelling step as the
maximum probability option, used as a default if no modelling is employed, tends to
underperform both logit models and histogram-based gradient
boosted classifiers. While the difference between logit and HGBC is not always
significant, some results suggest that the non-linear nature of HGBC provides better
performance than linear logit models.
%% W dimension
The last dimension focuses on the inclusion of the spatial lag in the modelling step as a
geographically-explicit method of capturing the context of each chip. This has one of
the most consistent effects on performance indicating the models that exclude spatial lag have worse
results than those that include it. Yet again, this step would not be possible in an
aspatial image classification context where two samples have no ``spatial'' distance from each
other hence no spatial weights matrix can be created. This is a clear evidence of the value
of explicitly spatial modelling in this context, and we can only recommend wider adoption of such methods.
% What is the best
Combining all the dimensions, we can assume that the optimal model for the detection of spatial
signatures from Sentinel 2 satellite imagery should define CNN for the multi-output
regression problem based on larger chip size and passing the output to non-linear
probability modelling with a spatial lag component.

% Ability to capture signatures % We can do some nicely, some worse. What is next?
Regardless of global performance, we cannot assume that even the best model will perform evenly across all 12
signature types. The within-class performance metrics indicate that some classes on the
extreme sides of the urban-rural dimension are easier to detect. That is not surprising
as both \textit{Urbanity} and \textit{Wild countryside} signature types are unique,
while the difference between \textit{Dense residential neighbourhoods} and
\textit{Connected residential neighbourhoods} that is visible on the satellite imagery
is much more subtle. It is also common that some of the classes are easier to
distinguish than others (\cite{zanaga_daniele_2021_5571936, karra2021global}). However,
any model deployed for periodical updates of signature classification will have to deal
with this limitation.

% limits
%% Sentinel 2 resolution
%% Chip sample imbalance
%% explain why segmentation is not used and tested
The experiments presented in this article focus on specific target data represented by
spatial signatures. Because the signatures are designed to capture the structure of
urban environments, the behaviour of spatial components in the modelling pipeline may
differ when target data are of a different nature. However, we argue that the principle
still holds in most cases. When the target data has a spatial dimension and a similar
structure to the spatial signatures (e.g. relatively large patches of a contiguous area
belonging to a single class), the explicit inclusion of spatial information in the
modelling pipeline will be beneficial as it directly embeds Tobler's first law of
geography into the model \citep{tobler1970computer}. This is a unique advantage of
geographical problems, unavailable when the task is aspatial. While this assumption is
only theoretical now, we believe that will can be empirically tested in future research.

Since this article is restricted to the use of open data at every step, the best current
resolution of satellite imagery is 10 meters per pixel, as offered by the Sentinel 2
mission. That poses some challenges because such a resolution limits the amount of
information we can capture on a small area and may oversimplify urban environments that
are naturally more granular in their patterns than what 10m can capture. Further
research should explore the performance differences when very-high-resolution
imagery is used instead.

The combination of signatures reflecting small-scale urban types and a relatively coarse
resolution leads to another limitation this work faces - the struggle to sample chips
in a balanced manner. This is most prominent in the baseline image classification
problem, where no pixels are shared among chips and all chips need to be exclusive to a
single signature type. The issue is alleviated by class weights in the neural network
architecture, but such a solution is not optimal.

%% What do we make of it in terms of geography
%%% Reiterate the point on the relevance of geography and how our results
%%% support that view and introduce explicitly-spatial/geographical ways to
%%% improve CV models for spatial imagery
Is geography relevant in image classification problems, then? The results presented
above suggest so. An introduction of explicit geographical methods to improve image
classification models based on spatial imagery proves to be beneficial and makes use of what a
unique - spatial - dimension offers. It requires moving beyond traditionally used
pre-trained models than have no sense of adjacency of individual chips/samples. We need
to take a step towards merging GIS expertise with the one that lies in the field of
AI, often based in departments of computer science rather than geography.

% the extent to which DL can be applied to understand urban environments
We can also conclude that when properly designed, deep learning models have a lot of potential
in characterisation of the composition of urban landscapes, if we want to answer the question
from the introduction. How well they perform varies across different signature types, meaning that
it will also vary across different types of urban environments when other classification than
signatures is considered. Nevertheless, we can foresee a variety of applications of
models of the sort presented and tested in this article. The spatial signatures are based on
a large number of data sources with limited temporal rate of updates (notably census data, updated every 10 years), making it nearly impossible to do yearly snapshots
of classification allowing longitudinal studies of evolution of cities. With the classification
derived from satellite imagery, we can expect to see a much higher temporal resolution,
easily resulting in annual updates, providing a detailed insight into the dynamics of urban
expansion, densification and overall change of the shape of cities. This is a potential
application that is not limited to spatial signatures but can be extended to any
classification of urban environments.


When using openly available satellite data that are currently limited to the resolution
of 10 meters per pixel at best, and classification focusing on primarily urban landscape,
our results show both potential and limits. Accuracy is not far from
that of established LULC models that could be increased in future by expansion of the training
data set and possible inclusion of other available bands (like near-infrared) in the model.
A limitation in decreased performance when it comes to distinction between urban areas that
are neither too dense nor too sparse but show different form and function profiles. It is
either a difference that is not visible on imagery (e.g. more driven by function) or a
limitation of the available resolution and / or training data volume. This issue could have
been primarily driven by the nature of spatial signatures as a classification target, and
it shall be tested on other types of urban classification in the future.

% finish with a very general note on the amount of sat data coming and the need to make
% sense of it
While satellite imagery and neural networks have been around for some time already, we
are just entering the era of an increasing abundance of satellite-based data. What used
to be reserved for national agencies and international consortia is becoming a domain of
commercial subjects. Research in the remote sensing area will face not a lack of
available data but the opposite. We may find ourselves in a situation where a vast
amount of data streams will come our way, but we will struggle to make sense of it. We
believe that the research presented in this article helps in finding our way through.
